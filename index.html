
<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Door</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #000000;
				margin: 0px;
				overflow: hidden;
			}

			#info {
				color: #fff;
				position: absolute;
				top: 10px;
				width: 100%;
				text-align: center;
				z-index: 100;
				display:block;

			}

			a { color: red }
		</style>
	</head>

	<body>
		<script src="three.js"></script>

		<script src="AssimpJSONLoader.js"></script>

		<script src="Detector.js"></script>
		<script src="stats.min.js"></script>

		<script>
		
		var door = null;

			if ( ! Detector.webgl ) {
				Detector.addGetWebGLMessage();
			}

			/*

			Simple demo for loading json files generated by assimp2json
			https://github.com/acgessler/assimp2json

			assimp2json uses assimp (http://assimp.sf.net) to import 40+ 3D file
			formats, including 3ds, obj, dae, blend, fbx, x, ms3d, lwo (and many
			more).

			TODOs:
			  - assimp supports skeletal animations and assimp2son exports
			    them. This demo currently doesn't read them.
			  - not all material properties supported by assimp are currently
			    mapped to THREE.js

			The sample files for this demo originate in assimp's repository,
			and were converted using assimp2json 2.0. The interior file was
			slightly edited to adjust for lower-case texture names.

			*/

			var container, stats;
			var camera, scene, renderer, objects;
			var clock = new THREE.Clock();

			// init scene
			init();

			var onProgress = function ( xhr ) {
				if ( xhr.lengthComputable ) {
					var percentComplete = xhr.loaded / xhr.total * 100;
					console.log( Math.round(percentComplete, 2) + '% downloaded' );
				}
			};

			var onError = function ( xhr ) {
			};

			// Load jeep model using the AssimpJSONLoader
			var loader1 = new THREE.AssimpJSONLoader();
			loader1.load( 'door.assimp.json', function ( object ) {
				for(var obj in object.children) {
					obj = object.children[obj];
					
					obj.children[0].material.color.setHex(0x290302);
					obj.children[0].material.shininess = 1;
				}

				object.scale.multiplyScalar( 0.003 );
		 object.rotation.set( -Math.PI/2, 0, 0);
		 object.position.add(new THREE.Vector3(0, -0.5, 0));
		 
				var bbox = new THREE.Box3().setFromObject(object);
				
				
				object.position.sub(
				(new THREE.Vector3(0,0,0)).copy(bbox.max).sub(bbox.min).multiplyScalar(0.5));
				
				object.position.add(new THREE.Vector3(0, 4, 0));
		 
		 
		 door = object;
				scene.add( object );
				
				
			}, onProgress, onError );
/*
			// load interior model
			var loader2 = new THREE.AssimpJSONLoader();
			loader2.load( 'interior.assimp.json', function ( object ) {

				scene.add( object );

			}, onProgress, onError );*/

			animate();


			//
			

			function init() {

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 2000 );
				camera.position.set( 0, 4, -5 );

				scene = new THREE.Scene();
				scene.fog = new THREE.FogExp2( 0x000000, 0.035 );

				// Lights
				scene.add( new THREE.AmbientLight( 0xcccccc ) );

				var directionalLight = new THREE.DirectionalLight( 0xeeeeee );
				directionalLight.position.x = Math.random() - 0.5;
				directionalLight.position.y = Math.random();
				directionalLight.position.z = Math.random() - 0.5;
				directionalLight.position.normalize();
				scene.add( directionalLight );
				
				
				
				
				var directionalLight2 = new THREE.DirectionalLight( 0xeeeeee );
				directionalLight2.position.x = 0;
				directionalLight2.position.y = 4;
				directionalLight2.position.z = -10;
				
				directionalLight2.target.position.set(new THREE.Vector3(0,0, 0));
				
				scene.add( directionalLight2 );
				
				
				
				var directionalLight3 = new THREE.DirectionalLight( 0xeeeeee );
				directionalLight3.position.x = 0;
				directionalLight3.position.y = 4;
				directionalLight3.position.z = 10;
				
				directionalLight3.target.position.set(new THREE.Vector3(0,0, 0));
				
				scene.add( directionalLight3 );
				
				
				

				// Renderer
				renderer = new THREE.WebGLRenderer();
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				
		renderer.setClearColor(0xffffff);
				container.appendChild( renderer.domElement );

				// Stats
				stats = new Stats();
				container.appendChild( stats.dom );

				// Events
				window.addEventListener( 'resize', onWindowResize, false );

			}

			//

			function onWindowResize( event ) {

				renderer.setSize( window.innerWidth, window.innerHeight );

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

			}

			//

			var t = 0;
			function animate() {

				requestAnimationFrame( animate );

				render();
				stats.update();
			}

			//
			
			var angle = 0;
			
			function render() {

				var timer = Date.now() * 0.0005;
				
				/*
				camera.position.x = 0;
				camera.position.y = 4;
				camera.position.z = -10;

				camera.lookAt( new THREE.Vector3(0,4,0) );
				*/
				if(door != null) {
					//door.rotation.setFromVector3( door.rotation.toVector3().add(new THREE.Vector3(0, 0, 0.01)));
					
					var CAM_DISTANCE = 10;
					var center = new THREE.Vector3(0,4,0);
					
					var en = 1 * (Math.PI/180);
					angle -= en;
					
	camera.position.copy(new THREE.Vector3 (
		center.x + Math.sin (angle) * CAM_DISTANCE,
		center.y,
		center.z + Math.cos (angle) * CAM_DISTANCE
	));

					camera.lookAt(center);
					
				}


				renderer.render( scene, camera );

			}

		</script>
	</body>
</html>
